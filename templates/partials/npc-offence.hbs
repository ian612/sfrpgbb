<h2>{{localize "sfrpgbb.attack.offence"}}</h2>
<div class="wrapper-movement">
    {{#if (hasData system.npcAbilities.movement)}}
    <b class="label">{{localize "sfrpgbb.movement.movement"}}:&nbsp;</b>
    {{#each system.npcAbilities.movement as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name"><b><a class="item-control item-edit" title="Edit Item">{{item.name}}</a></b></div>
        {{#if (isEqual item.system.value null false)}}<div class="item-quantity"><input type="number" value="{{item.system.value}}" data-dtype="Number" /></div>{{/if}}
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-melee">
    {{#if (hasData system.meleeWeapons)}}
    <b class="label">{{localize "sfrpgbb.attack.meleeWeapon"}}:&nbsp;</b>
    {{#each system.meleeWeapons as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name">
            <a class="item-control item-edit" title="Edit Item">{{item.name}}</a> {{numberFormat ../system.attack.melee.attackBonus decimals=0 sign=true}}
            {{#if (isEqual item.system.damageType "none" true)}}
                ({{localize "sfrpgbb.npc.noDamage"}})
            {{/if}}
            {{#if (isEqual item.system.damageType "none" false)}}
                ({{item.system.damage}}{{numberFormat ../system.attack.melee.damageBonus decimals=0 sign=true}} {{item.system.damageType}})
            {{/if}}
        </div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-melee">
    {{#if system.attack.multiattack}}
    <b class="label">{{localize "sfrpgbb.npc.multiattack"}}:&nbsp;</b>
    {{#each system.meleeWeapons as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name">
            {{#if (isEqual item.system.quantity 1 false)}} {{item.system.quantity}}x {{/if}}
            <a class="item-control item-edit" title="Edit Item">{{item.name}}</a> {{numberFormat ../system.attack.melee.multiattackBonus decimals=0 sign=true}}
            {{#if (isEqual item.system.damageType "none" true)}}
                ({{localize "sfrpgbb.npc.noDamage"}})
            {{/if}}
            {{#if (isEqual item.system.damageType "none" false)}}
                ({{item.system.damage}}{{numberFormat ../system.attack.melee.damageBonus decimals=0 sign=true}} {{item.system.damageType}})
            {{/if}}
        </div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-ranged">
    {{#if (hasData system.rangedWeapons)}}
    <b class="label">{{localize "sfrpgbb.attack.rangedWeapon"}}:&nbsp;</b>
    {{#each system.rangedWeapons as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name">
            <a class="item-control item-edit" title="Edit Item">{{item.name}}</a> {{numberFormat ../system.attack.ranged.attackBonus decimals=0 sign=true}}
            {{#if (isEqual item.system.damageType "none" true)}}
                ({{localize "sfrpgbb.npc.noDamage"}})
            {{/if}}
            {{#if (isEqual item.system.damageType "none" false)}}
                ({{item.system.damage}}{{#if (isEqual item.system.type "grenade" false)}}{{numberFormat ../system.attack.ranged.damageBonus decimals=0 sign=true}}{{/if}} {{item.system.damageType}}{{#if (isEqual item.system.type "grenade" true)}}, {{item.system.saveType}} {{localize "sfrpgbb.general.dc"}} {{item.system.saveDC}}{{/if}})
            {{/if}}
        </div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-spells">
    {{#if (hasData system.spellList.two)}}
    <b class="label">{{localize "sfrpgbb.spell.secondLevel"}} {{localize "sfrpgbb.spell.spells"}} [<div class="slots"><input type="number" name="system.spells.lvl2.max" value="{{system.spells.lvl2.max}}" data-dtype="Number" /></div>&nbsp;{{localize "sfrpgbb.spell.slot-s"}}]:&nbsp;</b>
    {{#each system.spellList.two as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name">
            <a class="item-control item-edit" title="Edit Item">{{item.name}}
                {{#if item.system.hasSave}} ({{localize "sfrpgbb.general.dc"}} {{add ../system.spells.spellDCBonus 12}} {{localize (concat "sfrpgbb.defence." item.system.saveType)}}) {{/if}}
                {{#if item.system.meleeAttack}} ({{numberFormat ../system.attack.melee.attackBonus decimals=0 sign=true}} {{localize "sfrpgbb.attack.meleeAttack"}}) {{/if}}
                {{#if item.system.rangedAttack}} ({{numberFormat ../system.attack.ranged.attackBonus decimals=0 sign=true}} {{localize "sfrpgbb.attack.rangedAttack"}}) {{/if}}
            </a>
        </div>
        <div class="item-controls">
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
        </div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-spells">
    {{#if (hasData system.spellList.one)}}
    <b class="label">{{localize "sfrpgbb.spell.firstLevel"}} {{localize "sfrpgbb.spell.spells"}} [<div class="slots"><input type="number" name="system.spells.lvl1.max" value="{{system.spells.lvl1.max}}" data-dtype="Number" /></div>&nbsp;{{localize "sfrpgbb.spell.slot-s"}}]:&nbsp;</b>
    {{#each system.spellList.one as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name">
            <a class="item-control item-edit" title="Edit Item">{{item.name}}
                {{#if item.system.hasSave}} ({{localize "sfrpgbb.general.dc"}} {{add ../system.spells.spellDCBonus 11}} {{localize (concat "sfrpgbb.defence." item.system.saveType)}}) {{/if}}
                {{#if item.system.meleeAttack}} ({{numberFormat ../system.attack.melee.attackBonus decimals=0 sign=true}} {{localize "sfrpgbb.attack.meleeAttack"}}) {{/if}}
                {{#if item.system.rangedAttack}} ({{numberFormat ../system.attack.ranged.attackBonus decimals=0 sign=true}} {{localize "sfrpgbb.attack.rangedAttack"}}) {{/if}}
            </a>
        </div>
        <div class="item-controls">
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
        </div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-spells">
    {{#if (hasData system.spellList.zero)}}
    <b class="label">{{localize "sfrpgbb.spell.zeroLevel"}} {{localize "sfrpgbb.spell.spells"}}:&nbsp;</b>
    {{#each system.spellList.zero as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name">
            <a class="item-control item-edit" title="Edit Item">{{item.name}}
                {{#if item.system.hasSave}} ({{localize "sfrpgbb.general.dc"}} {{add ../system.spells.spellDCBonus 10}} {{localize (concat "sfrpgbb.defence." item.system.saveType)}}) {{/if}}
                {{#if item.system.meleeAttack}} ({{numberFormat ../system.attack.melee.attackBonus decimals=0 sign=true}} {{localize "sfrpgbb.attack.meleeAttack"}}) {{/if}}
                {{#if item.system.rangedAttack}} ({{numberFormat ../system.attack.ranged.attackBonus decimals=0 sign=true}} {{localize "sfrpgbb.attack.rangedAttack"}}) {{/if}}
            </a>
        </div>
        <div class="item-controls">
            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
        </div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-other">
    {{#if (hasData system.npcAbilities.offence)}}
    <b class="label">{{localize "sfrpgbb.attack.offensiveAbilities"}}: </b>
    {{#each system.npcAbilities.offence as |item id|}}
    <div class="item flexrow" data-item-id="{{item.id}}">
        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
        <div class="item-name"><a class="item-control item-edit" title="Edit Item">{{item.name}}</a></div>
    </div>
    {{/each}}
    {{/if}}
</div>

<div class="wrapper-selector">

    <div class="row1">
        <div class="attack-melee">
            <b class="label">{{localize "sfrpgbb.npc.meleeAttack"}}</b>
            <div class="bonus">{{fetchPositive system.attack.melee.attackBonus}} <input name="system.attack.melee.attackBonus" type="number" value="{{system.attack.melee.attackBonus}}" data-dtype="Number" /></div>
        </div>
        <div class="damage-melee">
            <b class="label">{{localize "sfrpgbb.npc.meleeDamage"}}</b>
            <div class="bonus">{{fetchPositive system.attack.melee.damageBonus}} <input name="system.attack.melee.damageBonus" type="number" value="{{system.attack.melee.damageBonus}}" data-dtype="Number" /></div>
        </div>
        <div class="attack-ranged">
            <b class="label">{{localize "sfrpgbb.npc.rangedAttack"}}</b>
            <div class="bonus">{{fetchPositive system.attack.ranged.attackBonus}} <input name="system.attack.ranged.attackBonus" type="number" value="{{system.attack.ranged.attackBonus}}" data-dtype="Number" /></div>
        </div>
        <div class="damage-ranged">
            <b class="label">{{localize "sfrpgbb.npc.rangedDamage"}}</b>
            <div class="bonus">{{fetchPositive system.attack.ranged.damageBonus}} <input name="system.attack.ranged.damageBonus" type="number" value="{{system.attack.ranged.damageBonus}}" data-dtype="Number" /></div>
        </div>
        <div class="attack-multi">
            <b class="label">{{localize "sfrpgbb.npc.multiattack"}}</b>
            <input name="system.attack.multiattack" type="checkbox" {{checked system.attack.multiattack}} />
        </div>
        <div class="caster-select">
            <b class="label">{{localize "sfrpgbb.npc.isCaster"}}</b>
            <input name="system.spells.isCaster" type="checkbox" {{checked system.spells.isCaster}} />
        </div>
    </div>
    
    <div class="row2">
        {{#if system.spells.isCaster}}
        <div class="caster-bonus">
            <b class="label">{{localize "sfrpgbb.npc.spellDCBonus"}}</b>
            <div class="bonus">{{fetchPositive system.spells.spellDCBonus}} <input name="system.spells.spellDCBonus" type="number" value="{{system.spells.spellDCBonus}}" data-dtype="Number" /></div>
        </div>
        <div class="caster-type">
            <b class="label">{{localize "sfrpgbb.npc.casterType"}}</b>
            <select name="system.spells.casterType">
                {{#select system.spells.casterType}}
                    {{#each config.casterClasses as |name type|}}
                    <option value="{{type}}">{{localize name}}</option>
                    {{/each}}
                {{/select}}
            </select>
        </div>
        {{/if}}
    </div>

</div>

<!-- The above is temporary, will do something a little nicer later when I have more time -->